const y={},V=(e,t)=>e===t,P={equals:V};let W=M;const S={},b=1,C=2,R={owned:null,cleanups:null,context:null,owner:null};var c=null;let A=null,r=null,x=null,u=null,a=null,v=0;function J(e,t){const s=r,n=c,i=e.length===0?R:{owned:null,cleanups:null,context:null,owner:t||n};c=i,r=null;try{return q(()=>e(()=>D(i)),!0)}finally{r=s,c=n}}function k(e,t){t=t?Object.assign({},P,t):P;const s={value:e,observers:null,observerSlots:null,pending:S,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(s.pending!==S?s.pending:s.value)),O(s,i));return[X.bind(s),n]}function m(e,t,s){const n=Z(e,t,!1,b);U(n)}function K(e){if(x)return e();let t;const s=x=[];try{t=e()}finally{x=null}return q(()=>{for(let n=0;n<s.length;n+=1){const i=s[n];if(i.pending!==S){const f=i.pending;i.pending=S,O(i,f)}}},!1),t}function F(e){let t,s=r;return r=null,t=e(),r=s,t}function X(){const e=A;if(this.sources&&(this.state||e)){const t=u;u=null,this.state===b||e?U(this):N(this),u=t}if(r){const t=this.observers?this.observers.length:0;r.sources?(r.sources.push(this),r.sourceSlots.push(t)):(r.sources=[this],r.sourceSlots=[t]),this.observers?(this.observers.push(r),this.observerSlots.push(r.sources.length-1)):(this.observers=[r],this.observerSlots=[r.sources.length-1])}return this.value}function O(e,t,s){if(e.comparator&&e.comparator(e.value,t))return t;if(x)return e.pending===S&&x.push(e),e.pending=t,t;let n=!1;return e.value=t,e.observers&&e.observers.length&&q(()=>{for(let i=0;i<e.observers.length;i+=1){const f=e.observers[i];n&&A.disposed.has(f),(n&&!f.tState||!n&&!f.state)&&(f.pure?u.push(f):a.push(f),f.observers&&j(f)),n||(f.state=b)}if(u.length>1e6)throw u=[],new Error},!1),t}function U(e){if(!e.fn)return;D(e);const t=c,s=r,n=v;r=c=e,Y(e,e.value,n),r=s,c=t}function Y(e,t,s){let n;try{n=e.fn(t)}catch(i){H(i)}(!e.updatedAt||e.updatedAt<=s)&&(e.observers&&e.observers.length?O(e,n):e.value=n,e.updatedAt=s)}function Z(e,t,s,n=b,i){const f={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:c,context:null,pure:s};return c===null||c!==R&&(c.owned?c.owned.push(f):c.owned=[f]),f}function G(e){const t=A;if(e.state===0||t)return;if(e.state===C||t)return N(e);if(e.suspense&&F(e.suspense.inFallback))return e.suspense.effects.push(e);const s=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<v);)(e.state||t)&&s.push(e);for(let n=s.length-1;n>=0;n--)if(e=s[n],e.state===b||t)U(e);else if(e.state===C||t){const i=u;u=null,N(e,s[0]),u=i}}function q(e,t){if(u)return e();let s=!1;t||(u=[]),a?s=!0:a=[],v++;try{return e()}catch(n){H(n)}finally{_(s)}}function _(e){u&&(M(u),u=null),!e&&(a.length?K(()=>{W(a),a=null}):a=null)}function M(e){for(let t=0;t<e.length;t++)G(e[t])}function N(e,t){const s=A;e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];i.sources&&(i.state===b||s?i!==t&&G(i):(i.state===C||s)&&N(i,t))}}function j(e){const t=A;for(let s=0;s<e.observers.length;s+=1){const n=e.observers[s];(!n.state||t)&&(n.state=C,n.pure?u.push(n):a.push(n),n.observers&&j(n))}}function D(e){let t;if(e.sources)for(;e.sources.length;){const s=e.sources.pop(),n=e.sourceSlots.pop(),i=s.observers;if(i&&i.length){const f=i.pop(),l=s.observerSlots.pop();n<i.length&&(f.sourceSlots[l]=n,i[n]=f,s.observerSlots[n]=l)}}if(e.owned){for(t=0;t<e.owned.length;t++)D(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function H(e){throw e}function ee(e,t){return F(()=>e(t))}function $(e,t,s){let n=s.length,i=t.length,f=n,l=0,o=0,p=t[i-1].nextSibling,g=null;for(;l<i||o<f;){if(t[l]===s[o]){l++,o++;continue}for(;t[i-1]===s[f-1];)i--,f--;if(i===l){const h=f<n?o?s[o-1].nextSibling:s[f-o]:p;for(;o<f;)e.insertBefore(s[o++],h)}else if(f===o)for(;l<i;)(!g||!g.has(t[l]))&&t[l].remove(),l++;else if(t[l]===s[f-1]&&s[o]===t[i-1]){const h=t[--i].nextSibling;e.insertBefore(s[o++],t[l++].nextSibling),e.insertBefore(s[--f],h),t[i]=s[f]}else{if(!g){g=new Map;let d=o;for(;d<f;)g.set(s[d],d++)}const h=g.get(t[l]);if(h!=null)if(o<h&&h<f){let d=l,E=1,L;for(;++d<i&&d<f&&!((L=g.get(t[d]))==null||L!==h+E);)E++;if(E>h-o){const Q=t[l];for(;o<h;)e.insertBefore(s[o++],Q)}else e.replaceChild(s[o++],t[l++])}else l++;else t[l++].remove()}}}function te(e,t,s){let n;return J(i=>{n=i,t===document?e():z(t,e(),t.firstChild?null:void 0,s)}),()=>{n(),t.textContent=""}}function se(e,t,s){const n=document.createElement("template");n.innerHTML=e;let i=n.content.firstChild;return s&&(i=i.firstChild),i}function ne(e,t,s){s==null?e.removeAttribute(t):e.setAttribute(t,s)}function z(e,t,s,n){if(s!==void 0&&!n&&(n=[]),typeof t!="function")return T(e,t,n,s);m(i=>T(e,t(),i,s),n)}function T(e,t,s,n,i){for(y.context&&!s&&(s=[...e.childNodes]);typeof s=="function";)s=s();if(t===s)return s;const f=typeof t,l=n!==void 0;if(e=l&&s[0]&&s[0].parentNode||e,f==="string"||f==="number"){if(y.context)return s;if(f==="number"&&(t=t.toString()),l){let o=s[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),s=w(e,s,n,o)}else s!==""&&typeof s=="string"?s=e.firstChild.data=t:s=e.textContent=t}else if(t==null||f==="boolean"){if(y.context)return s;s=w(e,s,n)}else{if(f==="function")return m(()=>{let o=t();for(;typeof o=="function";)o=o();s=T(e,o,s,n)}),()=>s;if(Array.isArray(t)){const o=[];if(B(o,t,i))return m(()=>s=T(e,o,s,n,!0)),()=>s;if(y.context){for(let p=0;p<o.length;p++)if(o[p].parentNode)return s=o}if(o.length===0){if(s=w(e,s,n),l)return s}else Array.isArray(s)?s.length===0?I(e,o,n):$(e,s,o):(s&&w(e),I(e,o));s=o}else if(t instanceof Node){if(y.context&&t.parentNode)return s=l?[t]:t;if(Array.isArray(s)){if(l)return s=w(e,s,n,t);w(e,s,null,t)}else s==null||s===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);s=t}}return s}function B(e,t,s){let n=!1;for(let i=0,f=t.length;i<f;i++){let l=t[i],o;if(l instanceof Node)e.push(l);else if(!(l==null||l===!0||l===!1))if(Array.isArray(l))n=B(e,l)||n;else if((o=typeof l)=="string")e.push(document.createTextNode(l));else if(o==="function")if(s){for(;typeof l=="function";)l=l();n=B(e,Array.isArray(l)?l:[l])||n}else e.push(l),n=!0;else e.push(document.createTextNode(l.toString()))}return n}function I(e,t,s){for(let n=0,i=t.length;n<i;n++)e.insertBefore(t[n],s)}function w(e,t,s,n){if(s===void 0)return e.textContent="";const i=n||document.createTextNode("");if(t.length){let f=!1;for(let l=t.length-1;l>=0;l--){const o=t[l];if(i!==o){const p=o.parentNode===e;!f&&!l?p?e.replaceChild(i,o):e.insertBefore(i,s):p&&o.remove()}else f=!0}}else e.insertBefore(i,s);return[i]}export{k as a,ee as b,m as c,z as i,te as r,ne as s,se as t};
